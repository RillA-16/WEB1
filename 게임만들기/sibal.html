<script>
var card_image = ["../media/ë¡œë””.jpg", "../media/ë£¨í”¼.jpg", "../media/ë½€ë½€.jpg",
                  "../media/ì‚ì‚.jpg","../media/ì—ë””.jpg", "../media/í¬ë¡±.jpg",
                  "../media/í†µí†µì´.jpg", "../media/íŒ¨í‹°.jpg", "../media/í¬ë¹„.jpg",
                  "../media/í•´ë¦¬.jpg","../media/ë½€ë¡œë¡œ.jpg", "../media/ë’·ë©´.jpg"];

var card_answer = new Array(16);

var fail_emoticon = ["ğŸ˜¯", "ğŸ˜¥", "ğŸ˜¨", "ğŸ˜µ", "ğŸ¤®" ,"ğŸ¥¶", "ğŸ‘¿", "ğŸ¤¬"];

var openCount;

var firstCardIndex;

function shuffle() {
    // 0~15 ì¤‘ì— randomí•œ ìˆ˜
    var randomIndex = Math.floor(Math.random() * 16);
    console.log(randomIndex + 1 + "ë²ˆì§¸ ì¹´ë“œì— ë½€ë¡œë¡œê°€ ìˆ¨ì–´ìˆì–´ìš”");
    for(var i = 0; i < card_answer.length; i++){
        if(i === randomIndex){
            //ì •ë‹µ index
            card_answer[i] = 1;
        } else{
            //ì˜¤ë‹µ index
            card_answer[i] = 0;
        }
    }
}

function removeCards(){
    var cards = document.getElementsByClassName("cards-container")[0];
    var row = cards.getElementsByTagName("div");
    for(var i = row.length - 1; i >= 0 ; i--){
        cards.removeChild(row[i]);
    }
}

function setCards(){
    var cards = document.getElementsByClassName("cards-container")[0];
    for(var i = 0; i < 16; i++){
        if(i % 4 == 0){
            var row = document.createElement("div");
            cards.appendChild(row);
        }
        var card = document.createElement("img");
        card.className = "card";
        card.id = i;
        card.src = card_image[11];
        card.addEventListener("click", cardClick);
        row.appendChild(card);
    }
}

function cardClick(e){
    var clickedCard = e.target;
    open(clickedCard);
    clickedCard.removeEventListener("click", cardClick);
}

function open(card){
    openCount++;
    if(card_answer[card.id] === 1){
        showResult("ğŸ§ ë½€ë¡œë¡œ ì°¾ê¸° ì„±ê³µ ğŸ˜œ");
        document.body.style.backgroundColor = "rgb(230, 255, 255)";
        var card = document.getElementsByClassName("card");
        for(var i = 0; i < card.length; i++){
            card[i].removeEventListener("click", cardClick);
            card[i].src = card_image[10];
        }
    } else {
        card.src = card_image[(openCount + this.firstCardIndex) % 10];
        showResult("ì‹¤íŒ¨ " + fail_emoticon[Math.floor((openCount-1) / 2)]);
        if(openCount === 15){
            showResult("ë½€ë¡œë¡œ ì°¾ê¸° ì‹¤íŒ¨ " + fail_emoticon[7]);
            document.body.style.backgroundColor = "rgb(255, 230, 230)";
            var card = document.getElementsByClassName("card");
            for(var i = 0; i < card.length; i++){
                card[i].removeEventListener("click", cardClick);
                card[i].src = card_image[this.firstCardIndex];
            }
        }
    }
}

function showResult(text){
    var result = document.getElementsByClassName("result")[0];
    result.innerHTML = text;
}

function init(){
    showResult("ì¹´ë“œë¥¼ ëˆŒëŸ¬ ë½€ë¡œë¡œë¥¼ ì°¾ì•„ì£¼ì„¸ìš”!");
    shuffle();
    setCards();
    openCount = 0;
    firstCardIndex = Math.floor(Math.random() * 10);
    document.body.style.backgroundColor = "rgb(255, 255, 230)";
}

function restart(){
    removeCards();
    init();
}

</script>